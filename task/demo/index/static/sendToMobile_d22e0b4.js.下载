define("common:widget/ui/sendToMobile/sendToMobile.js",function(i,e,n){var o={deviceMap:{"iPhone1,1":"iPhone","iPhone1,2":"iPhone 3G","iPhone2,1":"iPhone 3GS","iPhone3,1":"iPhone 4","iPhone3,2":"iPhone 4","iPhone3,3":"iPhone 4","iPhone4,1":"iPhone 4S","iPhone5,1":"iPhone 5","iPhone5,2":"iPhone 5","iPhone5,3":"iPhone 5c","iPhone5,4":"iPhone 5c","iPhone6,1":"iPhone 5s","iPhone6,2":"iPhone 5s","iPhone7,2":"iPhone 6","iPhone7,1":"iPhone 6 Plus","iPhone8,1":"iPhone 6s","iPhone8,2":"iPhone 6s Plus","iPhone9,1":"iPhone 7","iPhone9,3":"iPhone 7","iPhone9,2":"iPhone 7 Plus","iPhone9,4":"iPhone 7 Plus","iPad1,1":"iPad","iPad2,1":"iPad 2","iPad2,2":"iPad 2","iPad2,3":"iPad 2","iPad2,4":"iPad 2","iPad3,1":"iPad 3","iPad3,2":"iPad 3","iPad3,3":"iPad 3","iPad3,4":"iPad 4","iPad3,5":"iPad 4","iPad3,6":"iPad 4","iPad4,1":"iPad Air","iPad4,2":"iPad Air","iPad4,3":"iPad Air","iPad5,3":"iPad Air 2","iPad5,4":"iPad Air 2"},warnMap:{1:"发生错误","-9":"单个地点每个设备每小时发送5条","-14":"发送失败,每个用户每天可以推送30条消息","-5":"请在手机系统中设置打开百度地图推送"},getMobile:function(i){var e=this,n={qt:"deviceInfoNew",type:i.type,uid:i.uid||"",routeInfo:i.routeInfo||"",t:+new Date},o=new Promise(function(i,o){var a,P=T.ajax("/?"+T.ajax.param(n),{dataType:"json",success:function(n){if(clearTimeout(a),0===n.status){var o=n.data.devices,P=o[0],d=T.cookie.get("deviceSend");d&&T.each(o,function(i,e){return e.id===d?(P=e,!1):void 0});var t=n.data.upass;i(P?{pass:t&&P.pass,id:P.id,name:e.deviceMap[P.mb]||P.mb||"未识别手机"}:!1)}},error:function(){o()}});a=setTimeout(function(){P.abort()},5e3)});return o},send:function(i){var e=this,n=i.device,o={devices:[{id:n.id}],uid:i.uid||"",type:i.type,channel:i.channel||"poi",routeInfo:i.routeInfo||""};o=T.ajax.param(o);var a=new Promise(function(i,a){var P,d=T.ajax("/?qt=messageCenterNew",{method:"POST",data:o,dataType:"json",success:function(o){clearTimeout(P),o&&0===o.status?T.each(o.data,function(o,P){0===P?(i(),T.cookie.set("deviceSend",n.id,{expires:6048e5})):a(e.warnMap[P])}):a(e.warnMap[1])},error:function(){clearTimeout(P),a(e.warnMap[1])}});P=setTimeout(function(){d.abort()},5e3)});return a}};n.exports=o});