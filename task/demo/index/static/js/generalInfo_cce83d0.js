define("poidetail:widget/ui/generalInfo/generalInfo.js",function(require,exports,module){var favMgr=require("common:widget/ui/fav/favMgr.js"),style='@charset "UTF-8";.poidetail-widget-generalInfo{}.poidetail-widget-generalInfo .clearfloat:after{display:block;clear:both;content:"";visibility:hidden;height:0}.poidetail-widget-generalInfo .clearfloat{zoom:1}.poidetail-widget-generalInfo .clampword{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.poidetail-widget-generalInfo .generalInfo-transform-common{-webkit-animation-duration:.5s;animation-duration:.5s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-delay:0s;animation-delay:0s}.poidetail-widget-generalInfo .generalInfo-pic{background-image:url(//webmap0.bdimg.com/wolfman/static/poidetail/images/generalInfo/detail-general-info_7a530db.png);background-repeat:no-repeat}.poidetail-widget-generalInfo .tips{box-sizing:border-box;width:100%;line-height:25px;height:52px;text-align:center;background:#ffffdf;border:1px solid #f4f4d3;color:#666;-webkit-transition:-webkit-transform .5s;transition:transform .5s;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}.poidetail-widget-generalInfo .tips .info-tip-img{background:url(/static/images/fav/tip.png) 0 0 no-repeat;width:18px;height:18px;vertical-align:middle;margin-right:8px}.poidetail-widget-generalInfo .tips.warning .info-tip-img{background-position:0 -18px}.poidetail-widget-generalInfo .tips .info-tip-text{vertical-align:-2px}.poidetail-widget-generalInfo .tips a{text-decoration:none;color:#666}.poidetail-widget-generalInfo .tips strong{color:#222}.poidetail-widget-generalInfo .tips-wrapper{pointer-events:auto;visibility:hidden;position:absolute;width:39%;top:38px;height:60px;right:0;bottom:-35px;z-index:1;-webkit-transition:visibility .5s;transition:visibility .5s;overflow:hidden}.poidetail-widget-generalInfo .tips-wrapper.active{visibility:visible}.poidetail-widget-generalInfo .tips-wrapper.active .tips{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.poidetail-widget-generalInfo .generalInfo-function-buttons{position:relative;height:38px;background-color:#fff;border-bottom:1px solid #EEE}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-nearby{text-align:center;float:left;width:20%;box-sizing:border-box;height:38px;overflow:hidden;cursor:pointer}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-nearby .buttons-nearby-icon{position:relative;width:10px;height:14px;background-position:0 -315px;display:inline-block;top:11px;vertical-align:top}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-nearby .buttons-nearby-text{line-height:38px;font-size:12px;color:#3385FF;display:inline-block;max-width:85%;top:0;padding-left:5px;box-sizing:border-box}.poidetail-widget-generalInfo .generalInfo-function-buttons .more-device{position:absolute;width:30px;height:30px;right:0;bottom:0;background:url(//webmap1.bdimg.com/wolfman/static/poidetail/images/generalInfo/more-device_fa448fe.png) no-repeat center center;cursor:pointer}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-send:hover{cursor:pointer}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-send:hover .buttons-send-icon{-webkit-animation-name:swing;animation-name:swing;-webkit-transform-origin:50% 100%;-ms-transform-origin:50% 100%;transform-origin:50% 100%}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-send{text-align:center;float:left;width:37%;box-sizing:border-box;height:38px;overflow:hidden}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-send .buttons-send-icon{position:relative;width:12px;height:14px;background-position:0 -44px;display:inline-block;top:11px;vertical-align:top}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-send .buttons-send-text{line-height:38px;font-size:12px;color:#3385FF;display:inline-block;max-width:85%;top:0;padding-left:5px;box-sizing:border-box}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-send .send2phone-tip{display:none;position:absolute;z-index:1000;width:190px;right:5px;top:45px;text-align:left;background:#fff;line-height:18px;padding:6px;border-radius:3px;color:#404040;border:solid 1px #cdcdcd;box-shadow:1px 2px #cdcdcd}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-fav:hover{cursor:pointer}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-fav:hover .buttons-fav-icon{-webkit-animation-name:bigsmall;animation-name:bigsmall;-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-fav{text-align:center;float:left;width:21%;box-sizing:border-box}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-fav .buttons-fav-icon{top:3px;position:relative;height:14px;width:14px;display:inline-block;background-position:-61px -2px}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-fav .buttons-fav-text{line-height:38px;font-size:12px;color:#3385FF;width:45px;margin-left:5px}.poidetail-widget-generalInfo .generalInfo-function-buttons .generalInfo-function-buttons-fav .has-faved{background-position:-33px -2px}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-share:hover{cursor:pointer}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-share:hover .buttons-share-arrow{-webkit-transform-origin:0 100%;-ms-transform-origin:0 100%;transform-origin:0 100%;-webkit-animation-name:righttopPop1;animation-name:righttopPop1;-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-share{float:left;width:20%;box-sizing:border-box;text-align:center}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-share .buttons-share-icon{text-align:left;top:5px;position:relative;height:15px;width:15px;display:inline-block;background-position:-124px -2px}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-share .buttons-share-arrow{top:-2px;position:relative;height:15px;width:15px;left:2px;display:inline-block;background-position:-148px -1px}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-share .buttons-share-text{line-height:38px;font-size:12px;color:#3385FF;position:relative;margin-left:5px}.poidetail-widget-generalInfo .generalInfo-function-buttons .function-buttons-padding{position:relative;height:18px;border-right:1px solid #EEE;top:10px;float:left}.poidetail-widget-generalInfo .generalInfo-damoce-link{border-top:1px solid #eee;width:100%;overflow:hidden}.poidetail-widget-generalInfo .generalInfo-address-telnum{font-size:0;background-color:#fff}.poidetail-widget-generalInfo .generalInfo-address-telnum .generalInfo-address{margin:0 10px;position:relative;overflow:hidden}.poidetail-widget-generalInfo .generalInfo-address-telnum .generalInfo-address .generalInfo-address-icon{height:16px;float:left;top:11px;width:14px;margin-left:6px;margin-right:3px;display:inline-block;background-position:0 -183px;position:relative}.poidetail-widget-generalInfo .generalInfo-address-telnum .generalInfo-address .generalInfo-address-text{font-size:12px;line-height:20px;padding:9px 0;overflow:hidden;display:block}.poidetail-widget-generalInfo .generalInfo-address-telnum .item{border-bottom:1px dashed #EEE}.poidetail-widget-generalInfo .generalInfo-address-telnum .item:last-child{border-bottom:0}.poidetail-widget-generalInfo .generalInfo-address-telnum .generalInfo-telnum{margin:0 10px;position:relative}.poidetail-widget-generalInfo .generalInfo-address-telnum .generalInfo-telnum .generalInfo-telnum-icon{height:16px;float:left;top:12px;width:14px;margin-left:7px;display:inline-block;background-position:0 -234px;position:relative}.poidetail-widget-generalInfo .generalInfo-address-telnum .generalInfo-telnum .generalInfo-telnum-text{width:90%;font-size:12px;line-height:38px;margin-left:3px;display:inline-block}@media only screen and (-webkit-min-device-pixel-ratio:2),(-webkit-min-device-pixel-ratio:2),(min-resolution:2dppx),(min-resolution:192dpi){#generalinfo .generalInfo-telnum .generalInfo-telnum-icon{margin-left:6px}}',sms=require("common:widget/ui/sms/sms.js"),sendToMobile=require("common:widget/ui/sendToMobile/sendToMobile.js"),toast=require("common:widget/ui/toast/toast.js"),searchbox=require("common:widget/ui/searchBox/searchBox.js"),cardMgr=require("common:widget/ui/card/cardMgr.js"),util=require("common:widget/ui/util/util.js");require.loadCss({content:style,name:"generalInfo"}),module.exports=Widget.extend({render:function(data){try{var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div id=\'generalinfo\' class="poidetail-widget-generalInfo bottom-split">    <div class=\'generalInfo-function-buttons clearfloat\'>        <div class="generalInfo-function-buttons-nearby">            <span class="generalInfo-pic generalInfo-transform-common buttons-nearby-icon"></span><span class="buttons-nearby-text">附近</span>        </div>        <div class=\'generalInfo-function-buttons-fav\'>            <span class="generalInfo-pic generalInfo-transform-common buttons-fav-icon ',"undefined"==typeof fav.favSelectedCls?"":fav.favSelectedCls,"\"></span><span class='buttons-fav-text'>","undefined"==typeof fav.favText?"":fav.favText,"</span>        </div>        <div class='function-buttons-share'>            <span class='generalInfo-pic generalInfo-transform-common buttons-share-icon'>                <span class='generalInfo-pic generalInfo-transform-common buttons-share-arrow'></span>            </span><span class='buttons-share-text'>分享</span>        </div>        <b class='function-buttons-padding'></b>        <div class='generalInfo-function-buttons-send'>            <span class='generalInfo-pic generalInfo-transform-common buttons-send-icon'></span><span class='buttons-send-text text-overflow'></span>            <div class=\"send2phone-tip\">安装百度地图客户端，并打开消息提醒即可在手机端接收信息</div>        </div>        <div class=\"tips-wrapper\">            <div class=\"tips\"></div>        </div>        <div class=\"more-device\"></div>    </div>    <div class='generalInfo-address-telnum'>        "),"undefined"!=typeof addr&&_template_fun_array.push("        <div class=\"generalInfo-address item\">            <span class='generalInfo-pic generalInfo-address-icon'></span>            <span class='generalInfo-address-text'>","undefined"==typeof addr?"":baidu.template._encodeHTML(addr),"</span>        </div>        "),_template_fun_array.push("        "),blockTel||(_template_fun_array.push("        "),"undefined"!=typeof phone&&_template_fun_array.push("        <div class=\"generalInfo-telnum item\">            <span class='generalInfo-pic generalInfo-telnum-icon'></span>            <span class='clampword generalInfo-telnum-text'>","undefined"==typeof phone?"":baidu.template._encodeHTML(phone),"</span>        </div>        "),_template_fun_array.push("        ")),_template_fun_array.push("    </div>    "),"undefined"!=typeof bizlink&&bizlink.forEach(function(e){e.tpl&&e.tpl.html&&_template_fun_array.push('    <div class="generalInfo-damoce-link">        ',"undefined"==typeof e.tpl.html?"":e.tpl.html,"    </div>    ")}),_template_fun_array.push("  </div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],datas=this.preProcessTemplateData(data),html=template(datas);return html}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"poidetail:widget/ui/generalInfo/generalInfo.js",ln:25})}},preProcessTemplateData:function(e){var n=!!favMgr.getModelByUid(e.uid),t="",i="加入收藏夹",o=i,a="收藏";return n&&(t="has-faved",i="取消收藏",o=i,a="已收藏"),e.fav={favSelectedCls:t,favTitle:i,favAlt:o,favText:a},e.bizlink&&0===e.bizlink.status&&e.bizlink.result&&e.bizlink.result.length?(e.bizlink=e.bizlink.result,e.bizlink.forEach(function(e){e.tpl&&e.tpl.css&&require.loadCss({content:e.tpl.css})})):e.bizlink=void 0,e.blockTel=e.blockTel||!1,e},renderComplete:function(e,n){function t(n,t){for(var i=e.find(".buttons-fav-icon"),o=e.find(".buttons-fav-text"),l=0;l<t.length;l++)if(t[l].uid===a){i.addClass("has-faved"),o.text("已收藏"),listener.trigger("searchModule.fav","click",{pos:i.offset()});break}}try{var i=this._data_,o=i.name,a=i.uid,l=i.addr,r=i.ext.detail_info.point||null;if(!r){var d=i.geo;d=d.split("|"),d=d.pop(),d=d.replace(/;$/,""),d=d.split(","),r={},r.x=d[0],r.y=d[1]}var s=0,f=i.city_id;i.area&&(296===f||87===f||345===f)&&(f=i.area),e.find(".generalInfo-function-buttons-nearby").on("click",function(e){e.stopPropagation(),addStat("poisearch.ui.nearby","click"),cardMgr.hideCards(),n.lockMarkerHighlight=!0,n.foldCard(!0),n.lockMarkerHighlight=!1,searchbox.setState("nearby",{center:{name:o,uid:a,point:r,cid:f}},{keepResult:!0})}),e.find(".more-device").on("click",function(e){addStat("ui.sendtomobile.more","click",{da_trd:"detail"}),sms.ready(e.target,a,s,f,"detail_info",null,{name:o,addr:l})}),e.find(".generalInfo-function-buttons-send").on("click",function(e){if(i.isBizPoi){var n=i.content.uid;addStat("ui.sendtomobile.defaultbuttonBizPoi","click",{uid:n,da_trd:"detail"})}else addStat("ui.sendtomobile.defaultbutton","click",{da_trd:"detail"});sms.ready(e.target,a,s,f,"detail_info",null,{name:o,addr:l})}),sendToMobile.getMobile({type:1,uid:a}).then(function(n){n&&n.name?(addStat("ui.sendtomobile.shortcut","show",{da_trd:"detail"}),e.find(".buttons-send-text").text("发送到"+n.name),e.find(".generalInfo-function-buttons-send").unbind().on("click",function(){var e={device:n,type:1,uid:a};if(addStat("ui.sendtomobile.shortcut","click",{da_trd:"detail"}),sendToMobile.send(e).then(function(){addStat("ui.sendtomobileshortcut.success","click"),toast.show("发送成功")},function(e){toast.show(e,"warning")}),i.isBizPoi){var t=i.content.uid;addStat("ui.sendtomobile.defaultbuttonBizPoi","click",{uid:t,da_trd:"detail"})}}),e.find(".generalInfo-function-buttons-send").on("mouseover",function(){e.find(".send2phone-tip").show()}),e.find(".generalInfo-function-buttons-send").on("mouseout",function(){e.find(".send2phone-tip").hide()})):(e.find(".buttons-send-text").text("发送到手机"),addStat("ui.sendtomobile.defaultbutton","show",{da_trd:"detail"}))},function(){e.find(".buttons-send-text").text("发送到手机"),addStat("ui.sendtomobile.defaultbutton","show",{da_trd:"detail"})}),n.addEventListener("unload",function(){listener.off("fav.poi.model","add",t)}),listener.on("fav.poi.model","add",t),e.find(".generalInfo-function-buttons-fav").on("click",function(){var e=T(this),n=e.find(".buttons-fav-icon"),t=e.find(".buttons-fav-text");if(n.hasClass("has-faved")?(favMgr.removeFav(a,"uid"),n.removeClass("has-faved"),t.text("收藏")):(addStat("newfav.poi.addfromdetail","click"),favMgr.addFav(1,{uid:a,name:o,x:r.x,y:r.y})),i.isBizPoi){var l=i.content.uid;addStat("poidetail.generalInfo.favBizPoi","click",{uid:l})}else addStat("poidetail.generalInfo.fav","click")}),e.find(".function-buttons-share").on("click",function(){var n=$(e).find(".generalInfo-function-buttons");if(require.async("common:widget/ui/toolShare/ToolShare.js",function(e){var t=window.temp.detailInfoPop,i=window.temp.linkPop;i&&i.close(),t&&t.visible?t.close():e.open({from:"detail_info",top:n.height()+n.offset().top,left:n.offset().left,width:n.width(),linkinfo:{poiShareUid:a}})}),i.isBizPoi){var t=i.content.uid;addStat("poidetail.generalInfo.shareBizPoi","click",{uid:t})}else addStat("poidetail.generalInfo.share","click")});var p=this;i.bizlink&&i.bizlink.forEach(function(n,t){n.tpl.js&&p.evalFunc(n.tpl.js,"damoce_poidetail_link_func",e.find(".generalInfo-damoce-link")[t])})}catch(g){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:g.message||g.description,path:"poidetail:widget/ui/generalInfo/generalInfo.js",ln:302})}},evalFunc:function(e,n,t){try{if(e&&n){var i=(new Date).getTime(),o=n+i,a=new RegExp("function\\s+"+n);e=e.replace(a,"window."+o+"=function"),util.evalScript(e),window[o]&&window[o](t),delete window[o]}}catch(l){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:l.message||l.description,path:"poidetail:widget/ui/generalInfo/generalInfo.js",ln:314})}},name:"generalInfo"})});