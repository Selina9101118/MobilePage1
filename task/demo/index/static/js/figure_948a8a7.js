define("poidetail:widget/ui/figure/figure.js",function(require,exports,module){var style=".poidetail-widget-figure{height:80px;box-sizing:border-box;overflow:hidden;position:relative}.poidetail-widget-figure *{box-sizing:border-box}.poidetail-widget-figure .col{float:left;position:relative;min-height:1px}.poidetail-widget-figure .pano-streetview,.poidetail-widget-figure .pano-indoor,.poidetail-widget-figure .picture{cursor:pointer}.poidetail-widget-figure .left-split{border-left:2px solid transparent}.poidetail-widget-figure .right-split{border-right:2px solid transparent}.poidetail-widget-figure .show{visibility:visible}.poidetail-widget-figure .hidden{visibility:hidden}.poidetail-widget-figure .scroll-list{position:absolute;left:0;top:0;-webkit-transition:left .3s ease-out;transition:left .3s ease-out}.poidetail-widget-figure .scroll-list li{float:left;width:122.667px!important;height:80px}.poidetail-widget-figure .scroll-list .add-photo{background:#fafafa}.poidetail-widget-figure .scroll-list .add-photo a{display:block;width:100%;height:100%;border:1px solid #eee;border-bottom-width:2px;background:url(//webmap1.bdimg.com/wolfman/static/poidetail/images/add-photo_9337fda.png) no-repeat center center;text-align:center}.poidetail-widget-figure .scroll-list .add-photo a span{position:relative;top:57px;color:#999}.poidetail-widget-figure .scroll-arrow{display:block;position:absolute;width:22px;height:22px;background-color:rgba(0,0,0,.6);top:29px;cursor:pointer}.poidetail-widget-figure .scroll-arrow .arrow{display:block;width:10px;height:17px;background:url(//webmap0.bdimg.com/wolfman/static/poidetail/images/scroll-arrow_30c6a10.png) no-repeat;position:absolute;left:6px;top:2px}.poidetail-widget-figure .scroll-arrow:hover{background-color:#3385ff}.poidetail-widget-figure .scroll-arrow.left-arrow{left:0}.poidetail-widget-figure .scroll-arrow.left-arrow .arrow{background-position:0 0}.poidetail-widget-figure .scroll-arrow.right-arrow{right:0}.poidetail-widget-figure .scroll-arrow.right-arrow .arrow{background-position:-10px 0}.poidetail-widget-figure .figure{width:100%;position:relative}.poidetail-widget-figure .figure img{display:block;width:100%;height:80px}.poidetail-widget-figure .figure .caption{width:100%;height:22px;line-height:22px;background:rgba(0,0,0,.6);color:#fff;left:0;bottom:0;position:absolute;font-size:12px;text-indent:10px}.figure-fadein{animation:open .25s;-webkit-animation:open .25s;-moz-animation:open .25s;-o-animation:open .25s;animation-timing-function:ease-in-out;-webkit-animation-timing-function:ease-in-out;-moz-animation-timing-function:ease-in-out;-o-animation-timing-function:ease-in-out}@keyframes open{from{height:0;opacity:0}to{height:80px;opacity:1}}@-webkit-keyframes open{from{height:0;opacity:0}to{height:80px;opacity:1}}@-moz-keyframes open{from{height:0;opacity:0}to{height:80px;opacity:1}}@-o-keyframes open{from{height:0;opacity:0}to{height:80px;opacity:1}}";require.loadCss({content:style,name:"figure"});var PanoInterface=require("pano:widget/PanoInterface/PanoInterface.js");module.exports=Widget.extend({render:function(data){try{var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push("");var imageNum=0;if(_template_fun_array.push(""),photos&&photos.data&&photos.data.photo_list){_template_fun_array.push("");var imageNum=photos.data.photo_list.length;_template_fun_array.push("")}if(_template_fun_array.push(""),hasPano||content.indoor_pano&&""!=content.indoor_pano||imageNum>0){if(_template_fun_array.push('<div class="poidetail-widget-figure top-border-override figure-fadein">'),hasPano){if(_template_fun_array.push(""),content.indoor_pano&&""!=content.indoor_pano){if(_template_fun_array.push(""),imageNum>0){_template_fun_array.push("");var photo_item=photos.data.photo_list[0];_template_fun_array.push('<div class="figure col-4 right-split pano-indoor"><img src="//mapsv0.bdimg.com/?qt=pr3d&panoid=',"undefined"==typeof content.indoor_pano_id?"":baidu.template._encodeHTML(content.indoor_pano_id),'&width=120&height=80&quality=80&fovx=50" srcset="//mapsv0.bdimg.com/?qt=pr3d&panoid=',"undefined"==typeof content.indoor_pano_id?"":baidu.template._encodeHTML(content.indoor_pano_id),'&width=240&height=160&quality=80&fovx=50 2x" /><p class="caption">内部全景&gt;</p></div><div class="figure col-4 right-split left-split pano-streetview"><img src="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.street_id?"":baidu.template._encodeHTML(content.street_id),'&width=120&height=80&quality=80&fovx=120" srcset="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.street_id?"":baidu.template._encodeHTML(content.street_id),'&width=240&height=160&quality=80&fovx=120 2x" /><p class="caption">街道全景&gt;</p></div><div class="figure col-4 left-split picture">'),photo_item.imgUrl?_template_fun_array.push('<img class="accept-default-image" src="//webmap0.bdimg.com/client/services/thumbnails?&width=120&height=80&quality=80&src=',"undefined"==typeof photo_item.imgUrl?"":baidu.template._encodeHTML(photo_item.imgUrl),'" srcset="//webmap0.bdimg.com/client/services/thumbnails?&width=240&height=160&quality=80&src=',"undefined"==typeof photo_item.imgUrl?"":baidu.template._encodeHTML(photo_item.imgUrl),' 2x" />'):_template_fun_array.push('<img class="accept-default-image" src="" srcset="" />'),_template_fun_array.push('<p class="caption">图片&gt;</p></div>')}else _template_fun_array.push('<div class="figure col right-split pano-indoor" style="width:67.4%"><img src="//mapsv0.bdimg.com/?qt=pr3d&panoid=',"undefined"==typeof content.indoor_pano_id?"":baidu.template._encodeHTML(content.indoor_pano_id),'&width=246&height=80&quality=80&fovx=300" srcset="//mapsv0.bdimg.com/?qt=pr3d&panoid=',"undefined"==typeof content.indoor_pano_id?"":baidu.template._encodeHTML(content.indoor_pano_id),'&width=492&height=160&quality=80&fovx=300 2x" /><p class="caption">内部全景&gt;</p></div><div class="figure col left-split pano-streetview"  style="width:32.6%"><img src="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.street_id?"":baidu.template._encodeHTML(content.street_id),'&width=120&height=80&quality=80&fovx=120" srcset="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.street_id?"":baidu.template._encodeHTML(content.street_id),'&width=240&height=160&quality=80&fovx=120 2x" /><p class="caption">街道全景&gt;</p></div>');_template_fun_array.push("")}else{if(_template_fun_array.push(""),imageNum>0){_template_fun_array.push("");var photo_item=photos.data.photo_list[0];_template_fun_array.push('<div class="figure col right-split pano-streetview" style="width:67.4%"><img src="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.uid?"":baidu.template._encodeHTML(content.uid),'&width=246&height=80&quality=80&fovx=240" srcset="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.uid?"":baidu.template._encodeHTML(content.uid),'&width=492&height=160&quality=80&fovx=240 2x" /><p class="caption">街道全景&gt;</p></div><div class="figure col left-split picture"  style="width:32.6%">'),photo_item.imgUrl?_template_fun_array.push('<img class="accept-default-image" src="//webmap0.bdimg.com/client/services/thumbnails?&width=120&height=80&quality=80&src=',"undefined"==typeof photo_item.imgUrl?"":baidu.template._encodeHTML(photo_item.imgUrl),'" srcset="//webmap0.bdimg.com/client/services/thumbnails?&width=240&height=160&quality=80&src=',"undefined"==typeof photo_item.imgUrl?"":baidu.template._encodeHTML(photo_item.imgUrl),' 2x" />'):_template_fun_array.push('<img class="accept-default-image" src="" srcset="" />'),_template_fun_array.push('<p class="caption">图片&gt;</p></div>')}else _template_fun_array.push('<div class="figure pano-streetview"><img src="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.street_id?"":baidu.template._encodeHTML(content.street_id),'&width=360&height=80&quality=80&fovx=360" srcset="//mapsv0.bdimg.com/pr/?qt=poiprv&uid=',"undefined"==typeof content.street_id?"":baidu.template._encodeHTML(content.street_id),'&width=720&height=160&quality=80&fovx=360 2x"/><p class="caption">进入街道全景&gt;</p></div>');_template_fun_array.push("")}_template_fun_array.push("")}else{_template_fun_array.push("");var scrollWidth=368*Math.ceil((imageNum+1)/3);_template_fun_array.push('<ul class="scroll-list" data-curPage="0" style="width:',"undefined"==typeof scrollWidth?"":baidu.template._encodeHTML(scrollWidth),'px">');for(var i=0;imageNum>i;i++){_template_fun_array.push("");var photo_item=photos.data.photo_list[i];_template_fun_array.push(""),_template_fun_array.push(i%3===0?'<li class="figure right-split picture">':i%3===1?'<li class="figure left-split right-split picture">':'<li class="figure left-split picture">'),_template_fun_array.push(""),photo_item.imgUrl?_template_fun_array.push('<img class="accept-default-image" id="',"undefined"==typeof i?"":baidu.template._encodeHTML(i),'" src="//webmap0.bdimg.com/client/services/thumbnails?&width=120&height=80&quality=80&src=',"undefined"==typeof photo_item.imgUrl?"":baidu.template._encodeHTML(photo_item.imgUrl),'" srcset="//webmap0.bdimg.com/client/services/thumbnails?&width=240&height=160&quality=80&src=',"undefined"==typeof photo_item.imgUrl?"":baidu.template._encodeHTML(photo_item.imgUrl),' 2x" />'):_template_fun_array.push('<img class="accept-default-image" id="',"undefined"==typeof i?"":baidu.template._encodeHTML(i),'" src="" srcset="" />'),_template_fun_array.push("</li>")}_template_fun_array.push(""),_template_fun_array.push(imageNum%3===0?'<li class="figure add-photo">':'<li class="figure add-photo left-split">'),_template_fun_array.push('<a href="http://map.baidu.com/ugc/upload/index?uid=',"undefined"==typeof content.uid?"":baidu.template._encodeHTML(content.uid),'" target="_blank"><span>添加图片</span></a></li></ul>'),imageNum>2&&_template_fun_array.push('<a href="javascript:;" class="scroll-arrow left-arrow hidden"><span class="arrow"></span></a><a href="javascript:;" class="scroll-arrow right-arrow active"><span class="arrow"></span></a>'),_template_fun_array.push("")}_template_fun_array.push("</div>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];data.hasPano=!!data.content.street_id,data.content.street_id=data.content.street_id||data.content.uid,data.detailPageUrl="#",data.hasDetailPage&&("movie"===data.industry&&(data.industry="shopping"),data.detailPageUrl="/detail?qt=ninf&uid="+data.content.uid+"&detail="+(data.originIndustry?data.originIndustry:data.industry)+"&from=poidetail&ugc_ver=1");for(var photoList=data.photos.data.photo_list,i=0;i<photoList.length;i++)photoList[i].imgUrl=encodeURIComponent(photoList[i].imgUrl);var html=template(data);return html}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"poidetail:widget/ui/figure/figure.js",ln:46})}},renderComplete:function(t){try{var e=this._data_;t.find("a").filter(function(){return"#"===T(this).attr("href")}).on("click",function(t){t.preventDefault()}),t.find(".pano-streetview, .pano-indoor").on("click",function(){var t="street";T(this).hasClass("pano-indoor")&&(t="inter");var i=($(this).attr("data-sid"),{uid:e.content.street_id,addr:e.content.addr,from:"detail",wd:e.content.name});PanoInterface.showPano({panoId:e.content.sid,panoType:t,searchParam:i,research:!0,from:"PoiDetail"}),"street"===t?addStat("poidetail.general.pano","click"):"inter"===t&&addStat("poidetail.general.pano-indoor","click")}),t.find(".scroll-arrow").on("click",function(){var e=t.find("ul.scroll-list"),i=t.find(".scroll-arrow.left-arrow"),a=t.find(".scroll-arrow.right-arrow"),o=e.find(">li").size(),r=e.attr("data-curPage")||0;r=parseInt(r,10);var n=Math.ceil(o/3)-1;T(this).hasClass("left-arrow")?r=Math.max(0,r-1):T(this).hasClass("right-arrow")&&(r=Math.min(n,r+1)),0===r?(i.removeClass("show").addClass("hidden"),a.removeClass("hidden").addClass("show")):r===n?(i.removeClass("hidden").addClass("show"),a.removeClass("show").addClass("hidden")):(i.removeClass("hidden").addClass("show"),a.removeClass("hidden").addClass("show")),e.attr("data-curPage",r).css("left",-368*r),addStat("poidetail.general.photos","click")}),t.find(".picture").on("click",function(t){var i=T.event.getTarget(t),a=i.id;require.async("poidetail:widget/ui/photoViewer/photoViewer.js",function(t){""===a&&(a=0);var i=new t(a);i.getPhotosData(e.content.uid,e.content.ext.src_name)}),addStat("poidetail.general.photoViewer","click")}),e.hasPano&&addStat("poidetail.general.pano","show"),addStat("poidetail.general.pano-indoor","show"),e.photos&&e.photos.data&&e.photos.data.photo_list&&e.photos.data.photo_list.length>0&&addStat("poidetail.general.photos","show")}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"poidetail:widget/ui/figure/figure.js",ln:146})}},name:"figure"})});