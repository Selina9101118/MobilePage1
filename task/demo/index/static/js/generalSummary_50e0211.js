define("poidetail:widget/ui/generalSummary/generalSummary.js",function(require,exports,module){var style=".poidetail-widget-generalsummary{padding:0 10px}.poidetail-widget-generalsummary .summaryContent{margin-top:8px;font-size:12px;line-height:24px}.poidetail-widget-generalsummary a{cursor:pointer;text-decoration:none;color:#3385FF}.poidetail-widget-generalsummary .summaryDescription{top:8px}",poiUtl=require("poidetail:widget/libs/poiDetailUtil/poiDetailUtil.js");require.loadCss({content:style,name:"generalSummary"}),module.exports=Widget.extend({render:function(data){try{var template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push(""),datas.isshow&&(_template_fun_array.push('<div class="poidetail-widget-generalsummary bottom-split"><div class="title"><span class="icon">简</span><span class="caption">简介</span></div>    '),ext.rich_info&&(_template_fun_array.push("        <div class='summaryContent'>            "),datas.description&&datas.description.length>0&&_template_fun_array.push("                <div class='summaryDescription'>                    <span class='span_summaryDescription'></span>                    <a class='a_summaryDescription' mode='description'></a>                </div>            "),_template_fun_array.push("            "),datas.atmosphere&&datas.atmosphere.length>0&&_template_fun_array.push("                <div class='summaryAtmosphere'>                    <span class='span_summaryAtmosphere'></span>                    <a class='a_summaryAtmosphere' mode='atmosphere'></a>                </div>            "),_template_fun_array.push("            "),datas.featured&&datas.featured.length>0&&_template_fun_array.push("                <div class='summaryFeatured'>                    <span class='span_summaryFeatured'></span>                    <a class='a_summaryFeatured' mode=featured></a>                </div>            "),_template_fun_array.push("            "),datas.timer&&datas.timer.length>0&&_template_fun_array.push("                <div class='summaryTime'>","undefined"==typeof datas.timer?"":baidu.template._encodeHTML(datas.timer),"</div>            "),_template_fun_array.push("        </div>    ")),_template_fun_array.push("</div>")),_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],datas=this.preProcessTemplateData(data),html=template(datas);return html}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"poidetail:widget/ui/generalSummary/generalSummary.js",ln:14})}},preProcessTemplateData:function(e){switch(e.industry){case"cater":if(e.ext.rich_info&&e.ext.rich_info.atmosphere&&e.ext.rich_info.atmosphere.length>0){var a="餐厅气氛："+e.ext.rich_info.atmosphere.replace(new RegExp(/,/g),"、");e.atmosphere=a}if(e.ext.rich_info&&e.ext.rich_info.featured_service&&e.ext.rich_info.featured_service.length>0){var t="特色服务："+e.ext.rich_info.featured_service;e.featured=t}this.processData(e);break;case"scope":e.ext&&e.ext.rich_info&&e.ext.rich_info.scope_type&&(e.description="景区类别："+e.ext.rich_info.scope_type),e.ext&&e.ext.detail_info&&e.ext.detail_info.entrance_price&&(e.atmosphere="门票价格："+e.ext.detail_info.entrance_price),e.ext&&e.ext.rich_info&&e.ext.rich_info.shop_hours&&(e.featured="开放时间："+e.ext.rich_info.shop_hours);break;case"moive":case"life":default:this.processData(e)}return e.isshow=e.description||e.atmosphere||e.timer||e.featured?!0:!1,e},processData:function(e){if(e.ext.rich_info&&e.ext.rich_info.description&&e.ext.rich_info.description.length>0){var a="商户描述："+e.ext.rich_info.description.replace(new RegExp(/&ldquo;|&rdquo;|&hellip;|&lsquo;|&rsquo;/g),"");e.description=a.replace(/<.+?>/g,"")}if(e.ext.rich_info&&e.ext.rich_info.shop_hours&&e.ext.rich_info.shop_hours.length>0){if(e.ext.detail_info.std_tag&&new RegExp("政府").test(e.ext.detail_info.std_tag))var t="办公时间："+e.ext.rich_info.shop_hours;else var t="营业时间："+e.ext.rich_info.shop_hours;e.timer=t}},renderComplete:function(e){try{var a=this._data_,t=a.description,r=a.atmosphere,i=a.featured,s=(a.timer,e.find(".a_summaryDescription")),n=e.find(".span_summaryDescription"),o=e.find(".a_summaryAtmosphere"),p=e.find(".span_summaryAtmosphere"),m=e.find(".a_summaryFeatured"),l=e.find(".span_summaryFeatured");this.preHandleString(s,n,t),this.preHandleString(o,p,r),this.preHandleString(m,l,i);var d=e.find(".summaryContent").find("a"),_=this;d.on("click",function(e){var a=$(e.target).attr("mode");switch(a){case"description":_.handelExpandCollapse(s,n,t);break;case"atmosphere":_.handelExpandCollapse(o,p,r);break;case"featured":_.handelExpandCollapse(m,l,i)}})}catch(u){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:u.message||u.description,path:"poidetail:widget/ui/generalSummary/generalSummary.js",ln:105})}},handelExpandCollapse:function(e,a,t){"+展开"==e.text()?(e.text("-收起"),a.text(t)):(e.text("+展开"),a.text(poiUtl.sub(t,102)))},preHandleString:function(e,a,t){t&&(poiUtl.len(t)>102?(a.text(poiUtl.sub(t,102)),e.text("+展开")):a.text(t))},name:"generalSummary"})});